# Terraform variables for jambonz medium cluster deployment on GCP

# ------------------------------------------------------------------------------
# GCP PROJECT CONFIGURATION
# ------------------------------------------------------------------------------

project_id = "drachtio-cpaas"
region     = "us-central1"
zone       = "us-central1-c"

# ------------------------------------------------------------------------------
# DEPLOYMENT CONFIGURATION
# ------------------------------------------------------------------------------

name_prefix = "jambonz"
environment = "production"

# ------------------------------------------------------------------------------
# NETWORK CONFIGURATION
# ------------------------------------------------------------------------------

vpc_cidr           = "172.20.0.0/16"
public_subnet_cidr = "172.20.10.0/24"

# ------------------------------------------------------------------------------
# NETWORK ACCESS CONTROLS
# ------------------------------------------------------------------------------

allowed_ssh_cidr  = ["0.0.0.0/0"]
allowed_http_cidr = ["0.0.0.0/0"]
allowed_sbc_cidr  = ["0.0.0.0/0"]

# ------------------------------------------------------------------------------
# IMAGE CONFIGURATION
# ------------------------------------------------------------------------------

# Images built with Packer in us-central1-c (2025-12-30)
feature_server_image = "projects/drachtio-cpaas/global/images/jambonz-fs-094-debian-12-20251230195659"
sbc_image            = "projects/drachtio-cpaas/global/images/jambonz-sip-rtp-094-debian-12-20251230151438"
web_monitoring_image = "projects/drachtio-cpaas/global/images/jambonz-web-monitoring-094-debian-12-20251230151342"
recording_image      = "projects/drachtio-cpaas/global/images/jambonz-recording-094-debian-12-20251230151414"

# ------------------------------------------------------------------------------
# MACHINE TYPE CONFIGURATION
# ------------------------------------------------------------------------------

sbc_machine_type            = "e2-standard-2"
feature_server_machine_type = "e2-standard-2"
web_monitoring_machine_type = "e2-standard-2"
recording_machine_type      = "e2-standard-2"

web_monitoring_disk_size = 200

# ------------------------------------------------------------------------------
# SBC CONFIGURATION
# ------------------------------------------------------------------------------

sbc_count = 1

# ------------------------------------------------------------------------------
# MANAGED INSTANCE GROUP CONFIGURATION
# ------------------------------------------------------------------------------

feature_server_target_size  = 1
feature_server_min_replicas = 1
feature_server_max_replicas = 3

recording_target_size  = 1
recording_min_replicas = 1
recording_max_replicas = 3

# Graceful scale-in timeout (max 900 seconds / 15 minutes)
scale_in_timeout_seconds = 900

# ------------------------------------------------------------------------------
# SSH CONFIGURATION
# ------------------------------------------------------------------------------

ssh_user       = "jambonz"
ssh_public_key = "ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAy6siMtEB6heB+xyGATunivJP5eUkWxN75YLtNGIqQ5g/BxRNlj/9ScjgHGVZWmEa/yGZlEvZUUdIToozSgRUNj7BwI3P3BwNOWNwZviEORTexz0IOAkLj1NYOtnS0JLIRoHAnDzk8cpFd85NupzsxA9is4lwpHJ/VHkIxZ1a14NES95Xm/Z9OVOM+UL4mY+sirAKiFDzFtF5d4YRVDvYBCRB+udBVcWkf1CjYDw0i59MSeqnssAyQj8ke+kdWo1sUqEL58wJ0bfqsN6EaPi1S7dIXyWO9Pf2uh9+T8dKQjoTPNrPNXqFJJlMu8JvVbqgQsxsCIQ7rEEpQiVQZe2xxQ== dhorton@dave-hortons-macbook-pro.local"

# ------------------------------------------------------------------------------
# DATABASE CONFIGURATION
# ------------------------------------------------------------------------------

mysql_tier      = "db-custom-2-4096"
mysql_disk_size = 20

# ------------------------------------------------------------------------------
# REDIS CONFIGURATION (Memorystore)
# No AUTH, no TLS - simple configuration
# ------------------------------------------------------------------------------

redis_memory_size_gb = 1
redis_tier           = "BASIC"

# ------------------------------------------------------------------------------
# JAMBONZ CONFIGURATION
# ------------------------------------------------------------------------------

url_portal               = "gcp.jambonz.io"
enable_pcaps             = true
deploy_recording_cluster = true