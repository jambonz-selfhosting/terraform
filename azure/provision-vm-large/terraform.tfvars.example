# Example Terraform variables for jambonz large cluster deployment on Azure
# Copy this file to terraform.tfvars and fill in your values

# ------------------------------------------------------------------------------
# REQUIRED VARIABLES
# You MUST provide values for these - Terraform will fail without them
# ------------------------------------------------------------------------------

# Azure credentials (get these with: az account show)
subscription_id = ""  # REQUIRED: Your Azure subscription ID
tenant_id       = ""  # REQUIRED: Your Azure tenant ID

# SSH public key for VM access
# Example: "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDx... user@host"
ssh_public_key = ""  # REQUIRED: Your SSH public key content

# DNS name for the jambonz portal
# You'll need to create DNS A records pointing to the server IPs for:
#   - jambonz.example.com             -> web_public_ip
#   - api.jambonz.example.com         -> web_public_ip
#   - public-apps.jambonz.example.com -> web_public_ip
#   - grafana.jambonz.example.com     -> monitoring_public_ip
#   - homer.jambonz.example.com       -> monitoring_public_ip
#   - jaeger.jambonz.example.com      -> monitoring_public_ip
#   - sip.jambonz.example.com         -> sip_public_ips[0]
url_portal = ""  # REQUIRED: e.g., "jambonz.example.com"

# ------------------------------------------------------------------------------
# JAMBONZ OPTIONS
# ------------------------------------------------------------------------------

# Enable PCAP capture for SIP traffic
enable_pcaps = true

# Deploy the recording server cluster
deploy_recording_cluster = true

# Database query caching (0 = disabled)
db_caching_tts = 0

# ------------------------------------------------------------------------------
# DEPLOYMENT CONFIGURATION
# ------------------------------------------------------------------------------

# Azure region - jambonz images are available in these regions:
#
# Americas:      eastus, eastus2, westus2, westus3, centralus,
#                northcentralus, southcentralus, canadacentral, brazilsouth
# Europe:        northeurope, westeurope, uksouth, francecentral,
#                germanywestcentral, swedencentral
# Asia Pacific:  australiaeast, southeastasia, japaneast, koreacentral, centralindia
#
# Need a different region? Contact support@jambonz.org
location = "eastus"

# Prefix for resource names (lowercase alphanumeric, 2-10 chars)
name_prefix = "jambonz"

# Environment label
environment = "production"

# ------------------------------------------------------------------------------
# NETWORK CONFIGURATION
# ------------------------------------------------------------------------------

# VNet and subnet CIDRs
vpc_cidr            = "172.20.0.0/16"
public_subnet_cidr  = "172.20.10.0/24"
public_subnet_cidr2 = "172.20.11.0/24"
mysql_subnet_cidr   = "172.20.20.0/24"

# ------------------------------------------------------------------------------
# NETWORK ACCESS CONTROLS
# Use x.x.x.x/32 for a single IP, or 0.0.0.0/0 for any IP (less secure)
# ------------------------------------------------------------------------------

allowed_ssh_cidr = "0.0.0.0/0"

# HTTP/HTTPS access
allowed_http_cidr = "0.0.0.0/0"

# SIP signaling access (TCP 5060-5061, 8443, UDP 5060)
allowed_sip_cidr = "0.0.0.0/0"

# RTP media access (UDP 40000-60000)
allowed_rtp_cidr = "0.0.0.0/0"

# ------------------------------------------------------------------------------
# JAMBONZ IMAGE CONFIGURATION
# Images are pulled from the jambonz Azure Community Gallery
# See https://docs.jambonz.org/releases for available versions
#
# Large deployment uses separate images for:
# - Web (portal/API only)
# - Monitoring (Grafana/Homer/Jaeger)
# - SIP (drachtio signaling)
# - RTP (rtpengine media)
# - Feature Server
# - Recording (optional)
# ------------------------------------------------------------------------------

# jambonz version (image version in community gallery)
jambonz_version = "10.0.4"

# Community gallery name (default should work for most users)
# community_gallery_name = "jambonz-8962e4f5-da0f-41ee-b094-8680ad38d302"

# ------------------------------------------------------------------------------
# VM SIZE CONFIGURATION
# See https://docs.microsoft.com/en-us/azure/virtual-machines/sizes
#
# Large deployment uses smaller VMs per role for cost efficiency:
# - Web: Standard_F2s_v2 (small, just portal/API)
# - Monitoring: Standard_F4s_v2 (larger for metrics storage)
# - SIP: Standard_F2s_v2 (CPU for signaling)
# - RTP: Standard_F2s_v2 (network for media)
# ------------------------------------------------------------------------------

web_vm_size            = "Standard_F2s_v2"
monitoring_vm_size     = "Standard_F4s_v2"
sip_vm_size            = "Standard_F2s_v2"
rtp_vm_size            = "Standard_F2s_v2"
feature_server_vm_size = "Standard_F4s_v2"
recording_vm_size      = "Standard_D2s_v3"

# Disk sizes
web_disk_size            = 100
monitoring_disk_size     = 200
sip_disk_size            = 100
rtp_disk_size            = 100
feature_server_disk_size = 100
recording_disk_size      = 100

# ------------------------------------------------------------------------------
# SERVER COUNTS
# Large deployment allows independent scaling of SIP and RTP servers
# ------------------------------------------------------------------------------

# Number of SIP servers (drachtio signaling)
sip_count = 1

# Number of RTP servers (rtpengine media)
rtp_count = 1

# ------------------------------------------------------------------------------
# SCALE SET CONFIGURATION
# Feature Server VMSS has higher max capacity for large deployments
# ------------------------------------------------------------------------------

feature_server_desired_capacity = 1
feature_server_min_capacity     = 1
feature_server_max_capacity     = 8

recording_desired_capacity = 1
recording_min_capacity     = 1
recording_max_capacity     = 8

# ------------------------------------------------------------------------------
# DATABASE CONFIGURATION
# Note: Azure restricts MySQL admin usernames - cannot use admin, root,
# administrator, azure_superuser, azure_pg_admin, etc.
# Default is "jambonz" which works with Azure restrictions.
# ------------------------------------------------------------------------------

# mysql_username = "jambonz"
# mysql_password = ""  # Leave empty to auto-generate

# MySQL SKU - see https://docs.microsoft.com/en-us/azure/mysql/flexible-server/concepts-service-tiers-storage
# Burstable: B_Standard_B1s, B_Standard_B1ms, B_Standard_B2s, B_Standard_B2ms
# General Purpose: GP_Standard_D2ds_v4, GP_Standard_D4ds_v4, etc.
# Memory Optimized: MO_Standard_E2ds_v4, MO_Standard_E4ds_v4, etc.
mysql_sku_name = "B_Standard_B2s"

# ------------------------------------------------------------------------------
# REDIS CONFIGURATION
# ------------------------------------------------------------------------------

# Redis SKU: Basic, Standard, Premium
redis_sku_name = "Standard"
redis_family   = "C"
redis_capacity = 1
